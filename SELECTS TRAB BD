/* NOME DOS CLIENTES E TODOS SEUS CONVIDADOS NAS FESTAS ENTRE 2010 E 2018 
    ORDENADOS PELO NOME DOS CLIENTES */

SELECT CLIENTE.NOME, CONVIDADO.NOME
    FROM FESTA JOIN CLIENTE
    ON (FESTA.CLIENTE = CLIENTE.CPF) AND ( EXTRACT(YEAR FROM FESTA.DATA_HORA) >= 2010) 
    AND ( EXTRACT(YEAR FROM FESTA.DATA_HORA) <= 2018)
    JOIN CONVIDADO
    ON (CONVIDADO.FESTA = FESTA.NOTAFISCAL)
    ORDER BY CLIENTE.NOME;


/* NOME E QUANTIDADE DE FESTAS DE CASAMENTO EM QUE CADA EQUIPE DE BUFE PARTICIPOU */

SELECT EQUIPEBUFE.NOME, COUNT(EQUIPEBUFE.CNPJ) AS "QUANTIDADE"
    FROM FESTA JOIN EQUIPEBUFE
    ON (FESTA.EQUIPEBUFE = EQUIPEBUFE.CNPJ) AND (FESTA.TIPO = 'CASAMENTO')
    GROUP (BY EQUIPEBUFE.CNPJ);


/*CPF E NOME ARTISTICO DE CADA ANIMADOR QUE PARTICIPOU DE PELO MENOS DUAS FESTA EM 2018 */

SELECT ANIMADOR.CPF, ANIMADOR.NOMEARTISTICO
    FROM FESTA JOIN CONTRATOANIMADOR
    ON (FESTA.NOTAFISCAL = CONTRATOANIMADOR.FESTA) 
    AND (EXTRACT(YEAR FROM FESTA.DATA) = 2018)
    JOIN PROFISSAO
    ON (PROFISSAO.ANIMADOR = CONTRATOANIMADOR.ANIMADOR)
    JOIN ANIMADOR
    ON (ANIMADOR.CPF = PROFISSAO.ANIMADOR)
    GROUP BY ANIMADOR.CPF, ANIMADOR.NOMEARTISTICO
    HAVING (COUNT(ANIMADOR.CPF) >= 2);


/* SELECIONAR NOTA FISCAL DE TODAS AS FESTAS E PARA AS QUE POSSUIREM, APRESENAR
    O NOME DA BANDA E SEU GENERO*/

SELECT FESTA.NOTAFISCAL, BANDA.NOME, BANDA.GENERO
    FROM CONTRATOBANDA JOIN BANDA
    ON (CONTRATOBANDA.CPF = BANDA.CPF) AND (CONTRATOBANDA.NOME = BANDA.NOME)
    RIGHT JOIN FESTA
    ON (FESTA.NOTAFISCAL = CONTRATOBANDA.FESTA)
